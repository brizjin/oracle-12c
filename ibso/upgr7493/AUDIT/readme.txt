1. Перед запуском установки необходимо убедиться, что на рабочей станции 
установлены следующие утилиты ORACLE sqlplus.exe и sqlldr.exe,
а также прописан путь (PATH) для их запуска в текущем ENVIRONMENT. 

2. Из-под пользователя с правами DBA (например, SYS) нужно создать 
владельца схемы аудита c помощью FIRST.BAT (в качестве параметра 
нужно указать коннект-строку к схеме с правами DBA). Будут запрошены 
имена самого владельца схемы, табличных пространств по умолчанию и 
временного для создаваемого пользователя.

3. Из-под владельца аудита (созданного в п.2) нужно создать объекты на 
его схеме с помощью MENU.BAT (в качестве параметра нужно указать коннект-строку к этой 
схеме, например: menu aud/aud@orcl ). После запуска на экране появится следующее меню:
AUDIT MENU

[1] Create/Upgrade schema tables (You must do this only once BEFORE all other actions)
[2] Enter diaries parameters (You must do this BEFORE create or upgrade owner)
[3] Upgrade owner
[4] Create owner
[5] Convert diaries
*** Other choices will mean exit ***
Enter choice [1]: 

Действия выполняемые в подпунктах:
[1] Для новой схемы создает:
а) таблицы для описания журналов аудита (diary_tables, diary_indexes, diary_partitions)
б) таблицу settings для хранения настроек аудита каждого владельца
в) представление (view) audit_settings, которое позволяет владельцам видеть только их нстройки
г) PL\SQL пакеты
Если запустить на старой схеме аудита: преобразует старую таблицу audit_settings
в таблицу settings и представление audit_settings, создаст недостающие таблицы и обновит
пакеты. 
НЕОБХОДИМО запустить хотя бы один раз на старой схеме или на только что созданной.

[2] Заполняет описания журналов аудита для владельца:
а) данные о таблицах и индексах
б) как часто предполагается очищать журналы (ежемесячно или ежеквартально), и,
соответственно, как их необходимо партифицировать.
в) в каких табличных пространствах хранить разделы(партиции) журналов и их индексов.
Можно запускать повторно, чтобы изменить данные. 
НЕОБХОДИМО запустить хотя бы один раз для каждого владельца (ПЕРЕД созданием или ПЕРЕД обновлением).
Возможности по редактированию данных ограничены, предполагается что для более
детальной настройки описания (diary_tables, diary_indexes, diary_partitions)
будут изменяться вручную.

Для каждого владельца создаются свои описания. При запуске спрашивается владелец,
табличные пространства по-умолчанию и параметры хранения для таблиц и индексов.
Далее запрашиваются табличные пространства для разделов(партиций).
Если в описании(diary_partitions) нет этих данных, берутся умолчательные,
введенные на предыдущем шаге(и сохраненные в diary_tables). Если нет умолчательных,
то табличные пространства будут выбираться базой данных.

Для ввода табличных пространств разделов есть три варианта:
а) Одинаковые для всех разделов (свои для таблиц и индексов)
б) Запрашивается префикс (свой для таблиц и индексов) и для каждого раздела к
префиксу добавляется '_' и номер раздела ('01'-'12' для помесячных журналов и
'A'-'D' для поквартальных).
в) Табличное пространство запрашивается для каждого раздела отдельно. При этом,
кроме 12 помесячных разделов и 4 поквартальных, запрашиваются по два барьерных
раздела для хранения данных не попадающих в диапазон дат, подлежащий партификации.
Их номера соответственно '00' и '13' для помесячных, '00' и '05' для поквартальных.
В пункте б) для них задаются умолчательные табличные пространства.

Следует иметь в виду, что команда НЕ создает журналов, а только определяет их описания. 
Для создания журналов следует запустить пункты [3] или [4].

[3] Upgrade владельца
а) добавляет в settings новые параметры и исправляет параметр VERSION
б) по описаниям, заданным в пункте [2], создает журналы и индексы.
в) преобразует данные журналов владельца в новый формат.
Запрашивает старую версию данных(среди других параметров). По умолчанию берет ее
из settings. Если задать старую версию данных 6.1 или выше, то преобразования 
данных журналов (форматов до версии 6.1) не будет производиться. 
Эту конвертацию можно выполнить отдельно (см. пункт [5]). 
Синхронизация структуры таблиц журналов (без преобразования самих данных)
производится в любом случае, это включает в себя приведение типов колонок,
добавление новых колонок, изменение опций партификации и распараллеливания
(в соответствии с заданными настройками).

[4] Создает владельца.
а) заполняет settings. Если данные уже были, на этом шаге ничего не произойдет.
б) создает журналы по описаниям, заданным в пункте [2]. если журналы уже были,
на этом шаге ничего не произойдет.

[5] Если старые данные владельца были восстановлены из файлов импорта
или не преобразованы в пункте [2], то их можно преобразовать здесь.

*** Если ввести любое другое значение(кроме 1-5) скрипт закончит свою работу.

ВАРИАНТЫ ИСПОЛЬЗОВАНИЯ:

1) Создание схемы аудита и владельцев
  Выполнить пункт [1]
  Для каждого владельца выполнить последовательно пункты [2] и [4]

2) Upgrade схемы аудита с преобразованием данных журналов владельцев
  из старого формата в новый.
  Выполнить пункт [1].
  Для каждого владельца выполнить последовательно пункты [2] и [3],
  причем в пункте [3] оставить старую версию владельца по умолчанию,
  либо ввести другое значение < 6.1.

3) Upgrade схемы аудита без преобразования форматов данных журналов 
  владельцев.
  Выполнить пункт [1].
  Для каждого владельца выполнить последовательно пункты [2] и [3],
  причем в пункте [3] указать старую версию владельца 6.1 или выше.


4. Исполняемый файл SECOND.BAT обновляет схему аудита в автоматическом режиме, 
при этом последовательно выполняются действия [1],[2],[3] из п.3 (Создание 
объектов схемы AUD, заполнение описаний журналов для владельца схемы IBSO, 
обновление журналов схемы IBSO).

5. При конвертации/обновлении журналов запрашивается дата для конвертации.
В случае, когда потребуется конвертация данных журналов (например, при 
преобразовании типов колонок) сконвертированы данные будут только начиная
с заданной даты, остальные данные будут уничтожены (если дату не задавать,
то сконвертированы будут все данные - этот вариант предлагается по
умолчанию).

6. Выгрузка журналов пакетами схемы аудита (через модуль "Рабочее место Ревизора")
осуществляется стандарными средствами работы с файлами Oracle (пакет
utl_file), для чего должны быть сконфигурированы доступные каталоги
для функций utl_file (конфигурационные настройки utl_file_dir или
должны быть созданы объекты типа DIRECTORY, доступные для схемы аудита).
